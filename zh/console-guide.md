## Compute > Instance > 控制台使用指南

## 创建实例

### 镜像

请选择安装操作系统所需的镜像。镜像可以从TOAST提供的公共镜像、已创建的用户自定义镜像、共享镜像中选择。

根据您使用的镜像，实例规格（flavor）会有所不同，因此创建实例时请先选择镜像后再进行后面的操作。

| 操作系统                        | 磁盘     | 内存   |
| -------------------------------- | ---------- | -------- |
| Linux<br>CentOS, Ubuntu, Debian | 20GB以上 | 1GB以上 |
| Windows                           | 50GB以上 | 2GB以上 |


### 可用区域(availability zone)

如果未明确设置可用区域，则将其设置为任意区域。根据可用区域决定此实例可用的块存储。如果要使用的块存储存在于特定的可用区域中，请将其设置为可用区域后使用。

> [参考] VPC的资源可以在所有可用区域中使用。

有关可用性区域的详细说明请参考[实例概述中的可用区域](/Compute/Instance/zh/overview/#_4)。

### 规格(flavor)

您可以根据虚拟硬件的性能来选择各种规格。但是，根据镜像要求的虚拟硬件性能，可选择的规格会受到限制。有关详细说明请参考[实例概述](./overview)。

实例在创建后，可以在TOAST控制台更改实例规格。可以从高规格降配为低规格，也可以从低规格升配为高规格。但部分规格是无法更改的，有关详细说明请参考[实例规格的更改](./console-guide/#_14)。 
> [注意] 实例的默认系统盘无法通过规格更改来变更。

### 磁盘空间

确定实例的默认系统盘大小。

- 创建实例后无法更改默认系统盘的大小。如果实例的磁盘容量不足，则需添加块存储。
- 磁盘的空间至少是镜像所需的最小容量。

实例的默认系统盘大小取决于实例的规格。

| 规格            | 支持的设备大小         |
| ----------------| -------------------------- |
| U 类型           | 固定为20G，无法更改 |
| T, M, C, R, X 类型 | 20~1000GB               |

>[参考] 根据磁盘空间的大小决定实际支付金额。因此磁盘的容量不要设置太大。建议您根据需求添加块存储。

### 实例数

创建多个镜像、可用区域、规格、磁盘容量、秘钥、网络设置相同的实例时使用实例数。此时的实例名称在设置的名称后面加数字`-1`, `-2`。例如，创建2个名为`my-instance`的实例，则会创建`my-instance-1`, `my-instance-2`的实例。一次可以创建的最多实例数为10个。
如果在任意的可用区域创建了多个实例，每个实例则创建在任意的可用区域。例如，2个实例创建在任意的可用区域时，此2个实例可能会在同一个可用领域，也可能在不同的可用区域。因此，所有实例需要在同一个可用区域时，请选择特定的可用区域后创建。

### 密钥对

您可以使用现有的密钥对或创建新的密钥对后使用。现有秘钥的注册方法，Windows用户请参考 [导入密钥对 (Windows用户)](./console-guide/#_16)、Mac及Linux 用户请参考[导入密钥对(Mac、Linux用户)](./console-guide/#_17)。

### 安全组

指定实例要所属的安全组。一个实例可以属于多个安全组。如果实例属于多个安全组时请注意以下事项。

- 属于各个安全组的所有实例都可以相互进行网络通信。对应具有敏感数据的实例，应防止其他实例的恶意访问，请慎重指定安全组。
- 聚合各安全组的所有规则并将其应用于该实例的外部通信。

安全组的详细说明请参考[VPC概述](/Network/VPC/zh/overview/)。

### 网络

在VPC定义的子网中选择连接实例的子网。每当选择一个子网时，都会在实例中创建连接到该子网的网络接口。您也可以更换被选择的子网的顺序来更改网络接口。此时，第一个网络接口(`eth0`)默认为网关。

网络创建及管理相关详细说明请参考[VPC概述](/Network/VPC/zh/overview/)。

## 实例添加功能

### 创建镜像

使用实例的默认系统盘创建镜像。创建镜像时为了确保数据的一致性，务必要在关闭实例的情况下进行。如果创建镜像命令是禁止状态，则必须先关闭该实例。

实例的默认系统盘中没有空间的情况下也可以创建镜像，但是无法为了将镜像用于其他实例而进行初始化。在创建镜像之前请确保实例具有至少100KB的可用空间。

创建的镜像在**Compute > Image**中注册为 Private镜像。使用已注册的镜像可以创建与原始实例磁盘相同的实例。

### 弹性IP绑定和解绑

不管实例的状态如何，您都可以绑定和解绑弹性IP。 如果没有可用的弹性IP或没有您所需要的弹性IP，则可以通过点击**创建**按钮创建弹性IP后绑定。或者，您也可以在 **Network > VPC > Floating IP**中创建弹性IP。

有关弹性IP相关的详细说明请参考[VPC概述](/Network/VPC/zh/overview/)。

### 更改安全组

不管实例的状态如何，您都可以更改实例的安全组，更改后可立即应用。

有关安全组的详细说明请参考[安全组](./console-guide/#_8)及[VPC 概述](/Network/VPC/zh/overview/)。

### 更改网络接口
不管实例的状态如何，您都可以添加或删除实例的网络接口。删除网路接口时，如果弹性IP绑定了接口，弹性IP也会解绑。解绑过的弹性IP，即使再次添加相同的网络接口也不会再次自动绑定，因此添加网路接口后需要再次绑定弹性IP。

### 更改实例规格

更改实例规格前要关闭实例。如果实例正在运行，请点击**追加功能**的**关闭实例**。

根据当前的规格，可更改的实例规格不同。

* M, C, R, T, X类型的实例可以更改为M, C, R, T, X类型的实例规格。
* M, C, R, T类型的实例无法更改为U类型的实例规格。
* I 类型的实例创建后无法更改规格。也无法更改为同样I类型的实例规格。
* U类型与I类型相同，创建后无法更改规格。也无法更改为同样U类型的实例规格。

更改实例规格时需要进行更改及验证更改操作。当所有的操作结束后VM状态更改为**Shutoff**状态，点击**追加功能**的 **Start instance**按钮即可启动实例。

> [参考]实例的默认系统盘大小无法更改。如果实例的磁盘空间不足，请添加块存储。有关块存储的添加方法请参考[块存储概述](/Storage/Block%20Storage/zh/overview/)。

付费时根据实例的更改时间为基准，按照更改后的规格来支付。

## 密钥对

### 导入密钥对(Windows用户)

安装PuTTY SSH客户端的同时会自动安装puttygen程序，利用此程序可以创建密钥对并将其注册到TOAST后使用。

设置[PuTTY](https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html)或运用韩语补丁的[iPuTTY](https://github.com/iPuTTY/iPuTTY/releases/tag/l0.70i)。 

启动puttygen。

![图1](http://static.toastoven.net/prod_instance/putty-ssh-001-en.png)

在**变量**中 选择**RSA**(或旧版本puttygen中的SSH-2 RSA)。点击 **操作** 的**创建**按钮。继续在空白区域移动鼠标以生成秘钥。

创建秘钥后，公钥文件内容如下所示。之后将整个公钥内容粘贴到**导入密钥对**中的 **公钥:** 字段以注册密钥对。

![图1](http://static.toastoven.net/prod_instance/putty-ssh-002-en.png)

点击**操作**中的**保存私密**按钮以保存私密。如果秘钥密码字段为空，点击保存时会出现 **确定不设置秘钥密码保护吗?**的提示。因此为了更安全地使用转换后的私钥，请设置私钥密码后保存。

> [注意]
如果想自动登录到实例，请不要使用私钥密码。如果使用了私钥密码，则必须在登录时手动输入秘钥的密码。

已注册的密钥对可以在创建实例时使用。访问实例时则需要此密钥对的私钥进行访问。有关实例的访问方法请参考[实例概述](./overview/#_9)。

与在TOAST创建的密钥对一样，利用此方式创建的密钥对的私钥如果一旦泄露，任何人都可以利用泄露的私钥访问实例，因此请慎重管理私钥。



### 导入密钥对(Mac、Linux用户)

利用Mac或Linux的`ssh-kegen`来创建的密钥对可以在TOAST上注册并使用。使用以下命令创建密钥对。

	$ ssh-keygen -t rsa -f my_key.key

您可以设置密钥对的密码，但不设置也不影响使用。为提高安全性，建议您设置密码。您输入的密钥对名称会自动追加.pub为扩展名,该文件里有公钥.
	$ cat my_key.key.pub
	ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCnnUAe36txQqk8J7VzbNuYKVQQ3gbNoClndHMX49OD+1Rw5xrDFLUKQqxbBDtlNMoA9tKBZNrQBpKr1kFEtvMIj1HPkH9ocb4MbuoVVjpkIhixbKMMJPDQ4JQJxaifsjR59YsZyDAp0aXZp+o+OB97P3S4AKPY2kQR0JdSr30+6Av6smf+3mZceAE4abzklfbyWT5slP1im/wfYEPO3QBEDl/0JbmTjKWPYI6QnbwnPRHS63SJ+Kd2QeYQYJCadv7X4mXnw81qEIWq/dx1SQkGDTNgR7lnN2ApFlU5EZcow69z6tiCr0hlyigwjGooMg3wTZvcSlYcVeTzZ755RArd ...

将整个内容粘贴到**导入密钥对**的**公钥:**字段中以注册密钥对。

已注册的密钥对可以在创建实例时使用。访问实例时则需要此密钥对的私钥进行访问。实例的访问方法请参考[实例概述](./overview/#_9)。

与在TOAST创建的密钥对一样，利用这种方式创建的密钥对的私钥如果一旦泄露，任何人都可以利用泄露的私钥访问实例，因此请慎重管理私钥。

