## Compute > Instance > 콘솔 사용 가이드

## 인스턴스 생성

### 이미지

원하는 운영체제가 설치된 이미지를 선택합니다. 이미지는 TOAST에서 제공하는 퍼블릭 이미지, 기존에 만들어둔 사용자 이미지, 공유 이미지에서 선택이 가능합니다.

이미지에 따라 필요한 인스턴스의 사양이 달라집니다. 

| 운영체제                         | 디스크     | 메모리   |
| -------------------------------- | ---------- | -------- |
| 리눅스<br>CentOS, Ubuntu, Debian | 20GB 이상  | 1GB 이상 |
| 윈도우                           | 50GB 이상  | 2GB 이상 |

사용할 이미지에 따라 인스턴스 사양이 달라지므로 인스턴스 생성 시에는 가장 먼저 이미지를 선택하고 진행하도록 합니다.

### 가용성 영역

가용성 영역을 명시적으로 설정하지 않는 경우, 임의의 영역으로 설정됩니다. 가용성 영역에 따라 이 인스턴스가 사용할 수 있는 블록 스토리지가 결정됩니다. 사용하려는 블록 스토리지가 특정 가용성 영역에 존재한다면 해당 가용성 영역으로 설정하여 사용합니다.

> [참고] VPC의 자원들은 모든 가용성 영역에서 사용할 수 있습니다.

가용성 영역에 대한 자세한 설명은 [인스턴스 개요의 가용성 영역](/Compute/Instance/ko/overview/#_4)을 참조합니다.

### 사양

[인스턴스 개요](./overview)에서 기술한 바와 같이 가상 하드웨어의 성능에 따라 다양한 사양을 선택할 수 있습니다. 다만, 이미지에서 요구하는 가상 하드웨어의 성능에 따라 선택할 수 있는 사양이 제한될 수 있습니다.

인스턴스의 사양은 생성 이후에도 TOAST 콘솔에서 변경할 수 있습니다. 높은 사양에서 낮은 사양으로 변경도 가능하며, 낮은 사양에서 높은 사양으로도 변경 가능합니다. 일부 사양은 변경이 불가능한 경우도 있으니, [인스턴스 사양 변경](./console-guide/#_14)을 참조합니다.

> [주의] 인스턴스의 기본 디스크는 사양 변경으로 바꿀 수 없습니다.

### 장치 크기

인스턴스의 기본 디스크 크기를 결정합니다.

- 기본 디스크의 크기는 인스턴스가 한번 생성되면 크기 변경을 할 수 없습니다. 인스턴스의 디스크 용량이 부족하다면 블록 스토리지를 추가하여 사용해야 합니다.
- 장치의 크기는 이미지가 요구하는 최소 크기 이상으로 만들어야 합니다.

인스턴스의 기본 디스크 크기는 인스턴스 사양에 따라 달라집니다.

| 사양            | 지원하는 장치 크기         |
| ----------------| -------------------------- |
| U 타입           | 20GB 로 고정되어 변경 불가 |
| T, M, C, R 타입 | 20 ~ 1000 GB               |
| I 타입          | 300GB 또는 600GB           |

>[참고] 장치 크기에 따라 과금되므로 기본 디스크의 크기를 무조건 크게 만드는 것은 비효율적입니다. 필요에 따라 블록 스토리지를 추가하여 사용하는 것이 좋습니다.

### 인스턴스 수

이미지, 가용성 영역, 사양, 장치 크기, 키페어, 네트워크 설정이 모두 동일한 인스턴스를 여러 개 생성할 경우에 사용합니다. 인스턴스의 이름은 설정한 이름 뒤에 `-1`, `-2`와 같이 번호를 붙여서 생성됩니다. 예를 들어, 인스턴스 이름을 `my-instance`로 인스턴스를 2개 만들면, `my-instance-1`, `my-instance-2`가 생성됩니다. 한번에 생성할 수 있는 최대 인스턴스의 개수는 10개입니다.

임의의 가용성 영역에 대해서 인스턴스를 여러 개 생성한 경우, 각각 인스턴스는 임의의 가용성 영역에 만들어집니다. 예를 들어, 2개의 인스턴스를 임의의 가용성 영역으로 생성한 경우, 2개가 같은 가용성 영역에 만들어 질 수도 있으며, 다른 가용성 영역에 만들어 질 수도 있습니다. 모든 인스턴스가 같은 가용성 영역에 생성되어야 한다면, 특정 가용성 영역을 선택하여 생성합니다.

### 키페어

기존 키페어를 사용하거나, 새로 키페어를 생성하여 사용합니다. 기존 키페어 등록은 윈도우 사용자의 경우 [키페어 가져오기 (윈도우 사용자)](./console-guide/#_16), 맥과 리눅스 사용자의 경우 [키페어 가져오기 (맥, 리눅스 사용자)](./console-guide/#_17)를 참조합니다.

### 보안 그룹

인스턴스가 속할 보안 그룹을 지정합니다. 인스턴스 하나는 여러 보안 그룹에 속할 수 있습니다. 인스턴스가 여러 보안 그룹에 속한 경우,

- 각 보안 그룹에 속한 모든 인스턴스와 네트워크 통신이 가능합니다. 다른 인스턴스의 의도하지 않은 접근을 막아야할 민감한 데이터를 가진 인스턴스의 경우에는 신중하게 보안 그룹을 지정해야 합니다.
- 각 보안 그룹의 모든 룰이 합쳐져서 해당 인스턴스의 외부 통신에 적용됩니다.

보안 그룹에 대한 자세한 설명은 [VPC 개요](/Network/VPC/ko/overview/)를 참조합니다.

### 네트워크

VPC에서 정의된 서브넷 중에서 인스턴스에 연결할 서브넷을 선택합니다. 서브넷을 하나 선택할 때마다 인스턴스에 해당 서브넷에 연결될 네트워크 인터페이스가 만들어집니다. 선택된 서브넷의 순서를 바꾸어서 네트워크 인터페이스를 변경할 수도 있습니다. 이 경우, 첫번째 네트워크 인터페이스(`eth0`)가 기본 게이트웨이로 설정됩니다.

네트워크 생성과 관리에 대한 자세한 설명은 [VPC 개요](/Network/VPC/ko/overview/)를 참조합니다. 

## 인스턴스 추가기능

### 이미지 생성

인스턴스의 기본 디스크로부터 이미지를 생성합니다. 이미지 생성은 데이터 정합성을 보장하기 위해 인스턴스를 종료한 상태에서만 진행할 수 있습니다. 이미지 생성 명령이 비활성화되어 있다면 먼저 인스턴스를 종료해야 합니다.

인스턴스의 기본 디스크의 여유 공간이 전혀 없는 상태에서 이미지 생성은 가능하나, 이미지를 다른 인스턴스에서 사용하기 위한 초기화 작업을 할 수 없어서 정상 사용이 불가능합니다. 이미지를 생성하기 전에 인스턴스에서 최소 100KB의 여유 공간을 만들도록 합니다.

생성된 이미지는 Compute > Image 에 Private 이미지로 등록됩니다. 등록된 이미지를 이용하여 원본 인스턴스와 동일한 디스크를 가진 인스턴스를 생성할 수 있습니다.

### 플로팅 IP 연결과 해제

인스턴스의 상태에 관계없이 플로팅 IP의 연결과 해제를 할 수 있습니다. 사용 가능한 플로팅 IP가 없거나 원하는 플로팅 IP가 없는 경우, **생성** 버튼으로 플로팅 IP를 생성하여 연결할 수 있습니다. 또는 Network > VPC > Floating IP 에서 플로팅 IP를 생성하여 사용해도 됩니다.

플로팅 IP에 대한 자세한 설명은 [VPC 개요](/Network/VPC/ko/overview/)를 참조합니다.

### 보안그룹 수정

인스턴스의 상태에 관계없이 인스턴스의 보안그룹을 수정할 수 있습니다. 수정된 보안그룹은 바로 적용됩니다.

보안 그룹에 대한 자세한 설명은 [보안 그룹](./console-guide/#_8)과 [VPC 개요](/Network/VPC/ko/overview/)를 참조합니다.

### 네트워크 인터페이스 수정

인스턴스의 상태에 관계없이 인스턴스의 네트워크 인터페이스를 추가하거나 삭제할 수 있습니다. 네트워크 인터페이스를 삭제할 때, 인터페이스에 플로팅 IP가 연결되어 있다면 플로팅 IP도 같이 연결해제 됩니다. 한번 연결해제된 플로팅 IP는 같은 네트워크 인터페이스를 다시 추가하더라도 자동으로 연결되지 않습니다. 네트워크 인터페이스 추가 후에 다시 원하는 플로팅 IP를 연결해야 합니다.

### 인스턴스 사양 변경

인스턴스 사양 변경은 인스턴스가 종료되어야 가능합니다. 인스턴스가 실행 상태라면 **추가기능**의 **인스턴스 종료**를 클릭하여 인스턴스를 종료합니다. 

인스턴스의 사양은 현재 사양에 따라 변경이 허용되는 인스턴스 사양이 다릅니다.

* M, C, R, T 타입의 인스턴스는 M, C, R, T 타입의 인스턴스 사양으로 변경 가능합니다.
* M, C, R, T 타입의 인스턴스는 I, U 타입의 인스턴스 사양으로 변경할 수 없습니다.
* I 타입은 생성 이후에 사양 변경이 불가능 합니다. 같은 I 타입의 인스턴스 사양으로도 변경할 수 없습니다.
* U 타입은 I타입과 마찬가지로 생성 이후에 사양 변경이 불가능 합니다. 같은 U 타입의 인스턴스 사양으로도 변경할 수 없습니다.

인스턴스 사양을 변경하면, 변경 작업과 변경 확인 작업이 진행됩니다. 모든 작업이 완료되면 VM 상태가 **Shutoff** 상태가 되며, **추가기능**의 **Start instance**를 클릭하여 인스턴스를 시작할 수 있습니다.

> [참고] 인스턴스의 기본 디스크 크기는 변경할 수 없습니다. 인스턴스의 디스크 공간이 부족하다면 블록 스토리지를 추가하여 사용합니다. 자세한 블록 스토리지 추가 방법은 [블록 스토리지 개요](/Storage/Block%20Storage/ko/overview/)를 참고합니다.

인스턴스는 변경 시점을 기준으로 변경된 사양으로 과금됩니다.

## 키페어

### 키페어 가져오기 (윈도우 사용자)

PuTTY ssh 클라이언트를 설치하면 함께 설치되는 puttygen 프로그램으로 키페어를 생성하고 TOAST에 등록하여 사용할 수 있습니다. [PuTTY](https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html) 또는 한글패치가 적용된 [iPuTTY](https://github.com/iPuTTY/iPuTTY/releases/tag/l0.70i)를 설치합니다. 

puttygen을 실행합니다.
![이미지1](http://static.toastoven.net/prod_instance/putty-ssh-001.png)
**매개변수**에서 RSA(또는 구 버전의 puttygen 에서는 SSH-2 RSA)를 선택합니다. **작업**에 있는 **생성** 버튼을 누릅니다. 키를 생성하기 위해서 빈공간 안에서 마우스를 계속 움직여 줍니다.

키가 생성되면 아래 그림처럼 공개 키 파일 내용이 보입니다. 공개 키 내용 전체를 **키페어 가져오기**의 **공개 Key:** 입력란에 붙여 넣어서 키페어를 등록합니다.
![이미지1](http://static.toastoven.net/prod_instance/putty-ssh-002.png)
**작업**의 **개인 키 저장** 버튼을 눌러 개인 키를 저장합니다. 키 암호어구를 빈 칸으로 두고 개인 키를 저장하면, "*암호어구로 보호하지 않은 채 이 키를 저장하겠습니까?*" 메시지가 나옵니다. 변환된 개인 키를 좀 더 안전하게 사용하려면 암호어구를 설정하여 저장하시기 바랍니다. 

> [주의]
인스턴스에 자동으로 로그인하여야 하는 경우에는 암호어구를 사용하지 않아야 합니다. 암호어구를 사용하면 로그인을 할 때 개인 키에 대한 패스워드를 키보드로 직접 입력해야 합니다.

등록한 키페어는 인스턴스를 생성할 때 사용할 수 있고, 인스턴스 접속 시에는 이 키페어의 개인 키로 접속하여야 합니다. 인스턴스 접속 방법은 [인스턴스 개요](./overview/#_9)를 참조합니다.

TOAST에서 생성한 키페어와 마찬가지로 이렇게 만든 키페어의 개인 키도 외부 유출 시에 누구나 유출된 개인 키를 통해 해당 인스턴스에 접근할 수 있게 되므로 신중하게 관리해야 합니다.



### 키페어 가져오기 (맥, 리눅스 사용자)

맥이나 리눅스의 `ssh-kegen`으로 만든 키페어를 TOAST에 등록하여 사용할 수 있습니다. 키페어는 다음 명령으로 생성합니다.

	$ ssh-keygen -t rsa -f my_key.key

키페어의 패스워드는 설정하여도 되지만 설정하지 않아도 사용 상의 문제는 없습니다. 높은 보안 수준을 위해서 패스워드 설정을 추천합니다. 입력한 키페어의 이름에 `.pub` 확장자가 추가된 파일 안에 키페어 공개 키가 들어 있습니다.

	$ cat my_key.key.pub
	ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCnnUAe36txQqk8J7VzbNuYKVQQ3gbNoClndHMX49OD+1Rw5xrDFLUKQqxbBDtlNMoA9tKBZNrQBpKr1kFEtvMIj1HPkH9ocb4MbuoVVjpkIhixbKMMJPDQ4JQJxaifsjR59YsZyDAp0aXZp+o+OB97P3S4AKPY2kQR0JdSr30+6Av6smf+3mZceAE4abzklfbyWT5slP1im/wfYEPO3QBEDl/0JbmTjKWPYI6QnbwnPRHS63SJ+Kd2QeYQYJCadv7X4mXnw81qEIWq/dx1SQkGDTNgR7lnN2ApFlU5EZcow69z6tiCr0hlyigwjGooMg3wTZvcSlYcVeTzZ755RArd ...

이 내용 전체를 **키페어 가져오기**의 **공개 Key:** 입력란에 붙여 넣어서 키페어를 등록합니다.

등록한 키페어는 인스턴스를 생성할 때 사용할 수 있고, 인스턴스 접속 시에는 이 키페어의 개인 키로 접속하여야 합니다. 인스턴스 접속 방법은 [인스턴스 접속 방법](./overview/#_9)을 참조합니다.

TOAST에서 생성한 키페어와 마찬가지로 이렇게 만든 키페어의 개인 키도 외부 유출 시에 누구나 유출된 개인 키를 통해 해당 인스턴스에 접근할 수 있게 되므로 신중하게 관리해야 합니다.


